@{
    Layout = "~/Views/Shared/_LayoutVue.cshtml";
    ViewBag.Title = "Vue Employee CRUD | Reactive Component-Based UI";
    ViewBag.MetaDescription = "A Vue 3 Single Page Application demonstrating reactive CRUD operations with the Composition API and declarative templates.";
    ViewBag.MetaKeywords = "Vue.js, Vue 3, Composition API, Reactive, CRUD operations, ASP.NET Core, SPA";
}

<div id="vue-root" v-cloak>
    <div class="container py-4">
        <div class="row mb-4">
            <div class="col-md-12">
                <div class="d-flex justify-content-between align-items-center mb-4">
                    <div>
                        <h1 class="h2 mb-0">
                            <i class="bi bi-filetype-vue text-primary me-2"></i>Vue Employee CRUD
                        </h1>
                        <p class="text-muted">Reactive CRUD with Vue 3 Composition API and RESTful API</p>
                    </div>
                    <button type="button" class="btn btn-primary" v-on:click="openAdd">
                        <i class="bi bi-plus-circle me-2"></i>Add Employee
                    </button>
                </div>

                <div class="card shadow-sm rounded-3 border-0">
                    <div class="card-body pb-0">
                        <div class="row mb-3">
                            <div class="col-md-6">
                                <div class="d-flex align-items-center">
                                    <label class="me-2"><i class="bi bi-list-ul"></i></label>
                                    <select class="form-select form-select-sm" style="width: auto"
                                            v-model.number="pageSize">
                                        <option :value="10">10 per page</option>
                                        <option :value="25">25 per page</option>
                                        <option :value="50">50 per page</option>
                                        <option :value="100">100 per page</option>
                                    </select>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="input-group input-group-sm">
                                    <span class="input-group-text"><i class="bi bi-search"></i></span>
                                    <input type="text" class="form-control"
                                           placeholder="Search employees..."
                                           v-model="searchTerm" />
                                    <button class="btn btn-outline-secondary" v-if="searchTerm"
                                            v-on:click="searchTerm = ''">
                                        <i class="bi bi-x"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Loading -->
                    <div class="card-body p-0" v-if="loading">
                        <div class="text-center py-5">
                            <div class="spinner-border text-primary" role="status">
                                <span class="visually-hidden">Loading...</span>
                            </div>
                            <p class="text-muted mt-2">Loading employees...</p>
                        </div>
                    </div>

                    <!-- Table -->
                    <div class="card-body p-0" v-else>
                        <div class="table-responsive">
                            <table class="table table-striped table-hover mb-0">
                                <thead class="table-dark">
                                    <tr>
                                        <th>Profile</th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('name')">
                                            Name<i class="ms-1" :class="sortIcon('name')"></i>
                                        </th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('genderName')">
                                            Gender<i class="ms-1" :class="sortIcon('genderName')"></i>
                                        </th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('age')">
                                            Age<i class="ms-1" :class="sortIcon('age')"></i>
                                        </th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('state')">
                                            State<i class="ms-1" :class="sortIcon('state')"></i>
                                        </th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('country')">
                                            Country<i class="ms-1" :class="sortIcon('country')"></i>
                                        </th>
                                        <th role="button" class="user-select-none" v-on:click="toggleSort('departmentName')">
                                            Department<i class="ms-1" :class="sortIcon('departmentName')"></i>
                                        </th>
                                        <th class="text-center">Actions</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr v-if="paginated.length === 0">
                                        <td colspan="8" class="text-center text-muted py-4">
                                            <template v-if="searchTerm">
                                                <i class="bi bi-search me-2"></i>No employees match your search.
                                            </template>
                                            <template v-else>
                                                <i class="bi bi-inbox me-2"></i>No employees found.
                                            </template>
                                        </td>
                                    </tr>
                                    <tr v-for="emp in paginated" :key="emp.id">
                                        <td class="text-center align-middle">
                                            <img :src="'/images/' + (emp.profile_picture || 'default.jpg')"
                                                 class="rounded-circle" height="40" width="40"
                                                 :alt="emp.name"
                                                 v-on:error="$event.target.src = '/images/default.jpg'" />
                                        </td>
                                        <td class="align-middle">{{ emp.name }}</td>
                                        <td class="align-middle">{{ emp.genderName }}</td>
                                        <td class="align-middle">{{ emp.age }}</td>
                                        <td class="align-middle">{{ emp.state }}</td>
                                        <td class="align-middle">{{ emp.country }}</td>
                                        <td class="align-middle">{{ emp.departmentName }}</td>
                                        <td class="text-center align-middle">
                                            <div class="btn-group" role="group">
                                                <button class="btn btn-sm btn-outline-primary"
                                                        v-on:click="openEdit(emp.id)">
                                                    <i class="bi bi-pencil-square"></i> Edit
                                                </button>
                                                <button class="btn btn-sm btn-outline-danger"
                                                        v-on:click="openDelete(emp)">
                                                    <i class="bi bi-trash"></i> Delete
                                                </button>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card-footer bg-light">
                        <div class="d-flex justify-content-between align-items-center">
                            <span class="text-muted small">
                                Showing {{ sorted.length === 0 ? 0 : (currentPage - 1) * pageSize + 1 }}
                                to {{ Math.min(currentPage * pageSize, sorted.length) }}
                                of {{ sorted.length }} employees
                                <template v-if="searchTerm"> (filtered from {{ employees.length }} total)</template>
                            </span>
                            <nav v-if="totalPages > 1" aria-label="Employee pagination">
                                <ul class="pagination pagination-sm mb-0 justify-content-end">
                                    <li class="page-item" :class="{ disabled: currentPage === 1 }">
                                        <button class="page-link" v-on:click="currentPage = 1"><i class="bi bi-chevron-double-left"></i></button>
                                    </li>
                                    <li class="page-item" :class="{ disabled: currentPage === 1 }">
                                        <button class="page-link" v-on:click="currentPage--"><i class="bi bi-chevron-left"></i></button>
                                    </li>
                                    <li class="page-item" v-for="p in visiblePages" :key="p" :class="{ active: p === currentPage }">
                                        <button class="page-link" v-on:click="currentPage = p">{{ p }}</button>
                                    </li>
                                    <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                                        <button class="page-link" v-on:click="currentPage++"><i class="bi bi-chevron-right"></i></button>
                                    </li>
                                    <li class="page-item" :class="{ disabled: currentPage === totalPages }">
                                        <button class="page-link" v-on:click="currentPage = totalPages"><i class="bi bi-chevron-double-right"></i></button>
                                    </li>
                                </ul>
                            </nav>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Employee Form Modal -->
        <div class="modal fade" id="vueFormModal" tabindex="-1" aria-hidden="true" ref="formModalEl">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header bg-light">
                        <h5 class="modal-title">{{ formEmployee.id > 0 ? 'Update Employee' : 'Add Employee' }}</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="vueEmployeeForm" :class="{ 'was-validated': formValidated }" novalidate
                              v-on:submit.prevent="handleSave">
                            <div class="mb-3">
                                <label for="vueName" class="form-label">Name</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-person"></i></span>
                                    <input type="text" class="form-control" id="vueName"
                                           v-model="formEmployee.name" placeholder="Enter employee name" required />
                                    <div class="invalid-feedback">Please enter a name</div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="vueGender" class="form-label">Gender</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-gender-ambiguous"></i></span>
                                    <select class="form-select" id="vueGender" v-model="formEmployee.gender" required>
                                        <option value="" disabled>Select gender</option>
                                        <option :value="0">Male</option>
                                        <option :value="1">Female</option>
                                        <option :value="2">Non-Binary</option>
                                    </select>
                                    <div class="invalid-feedback">Please select a gender</div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="vueAge" class="form-label">Age</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-calendar3"></i></span>
                                    <input type="number" class="form-control" id="vueAge"
                                           v-model.number="formEmployee.age" placeholder="Enter age" min="18" required />
                                    <div class="invalid-feedback">Please enter age (minimum 18)</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="vueState" class="form-label">State</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-geo-alt"></i></span>
                                        <input type="text" class="form-control" id="vueState"
                                               v-model="formEmployee.state" placeholder="Enter state" required />
                                        <div class="invalid-feedback">Please enter state</div>
                                    </div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="vueCountry" class="form-label">Country</label>
                                    <div class="input-group">
                                        <span class="input-group-text"><i class="bi bi-globe"></i></span>
                                        <input type="text" class="form-control" id="vueCountry"
                                               v-model="formEmployee.country" placeholder="Enter country" required />
                                        <div class="invalid-feedback">Please enter country</div>
                                    </div>
                                </div>
                            </div>
                            <div class="mb-3">
                                <label for="vueDepartment" class="form-label">Department</label>
                                <div class="input-group">
                                    <span class="input-group-text"><i class="bi bi-building"></i></span>
                                    <select class="form-select" id="vueDepartment" v-model.number="formEmployee.department" required>
                                        <option value="" disabled>Select department</option>
                                        <option v-for="d in departments" :key="d.id" :value="d.id">{{ d.name }}</option>
                                    </select>
                                    <div class="invalid-feedback">Please select a department</div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer bg-light">
                        <button type="submit" form="vueEmployeeForm"
                                :class="'btn ' + (formEmployee.id > 0 ? 'btn-success' : 'btn-primary')"
                                :disabled="saving">
                            <template v-if="saving">
                                <span class="spinner-border spinner-border-sm me-1"></span> Saving...
                            </template>
                            <template v-else-if="formEmployee.id > 0">
                                <i class="bi bi-check-circle me-1"></i> Update
                            </template>
                            <template v-else>
                                <i class="bi bi-plus-circle me-1"></i> Add
                            </template>
                        </button>
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i> Close
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="vueDeleteModal" tabindex="-1" aria-hidden="true" ref="deleteModalEl">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header bg-danger text-white">
                        <h5 class="modal-title">
                            <i class="bi bi-exclamation-triangle me-2"></i>Confirm Delete
                        </h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <p>Are you sure you want to delete <strong>{{ deleteTarget?.name }}</strong>?</p>
                        <p class="text-muted mb-0">This action cannot be undone.</p>
                    </div>
                    <div class="modal-footer bg-light">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="bi bi-x-circle me-1"></i> Cancel
                        </button>
                        <button type="button" class="btn btn-danger" v-on:click="handleDelete">
                            <i class="bi bi-trash me-1"></i> Delete
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Toast Container -->
        <div class="toast-container position-fixed bottom-0 end-0 p-3">
            <div v-for="t in toasts" :key="t.id"
                 :class="'toast show align-items-center text-white bg-' + t.type + ' border-0'"
                 role="alert">
                <div class="d-flex">
                    <div class="toast-body">
                        <strong>{{ t.title }}:</strong> {{ t.message }}
                    </div>
                    <button type="button" class="btn-close btn-close-white me-2 m-auto"
                            v-on:click="dismissToast(t.id)"></button>
                </div>
            </div>
        </div>

        <!-- Documentation Section -->
        <div class="row mt-5">
            <div class="col-md-12">
                <div class="card shadow-sm rounded-3 border-0 mb-4">
                    <div class="card-header bg-primary text-white">
                        <h3 class="mb-0"><i class="bi bi-info-circle me-2"></i>About Vue Implementation</h3>
                    </div>
                    <div class="card-body p-4">
                        <p class="lead">
                            This implementation demonstrates a Vue 3 SPA using the Composition API loaded via CDN.
                            It consumes the same RESTful endpoints as the React implementation but uses Vue's
                            reactive data binding and declarative template syntax.
                        </p>

                        <div class="row g-4 mt-2">
                            <div class="col-md-6">
                                <div class="card h-100 bg-light border-0">
                                    <div class="card-body">
                                        <h4 class="card-title"><i class="bi bi-stars text-warning me-2"></i>Vue Advantages</h4>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-check-circle-fill text-success me-2"></i>Gentle learning curve with familiar HTML templates</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-check-circle-fill text-success me-2"></i>Fine-grained reactivity system (no Virtual DOM diffing)</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-check-circle-fill text-success me-2"></i>Composition API for clean, reusable logic</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-check-circle-fill text-success me-2"></i>Two-way binding with v-model simplifies forms</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>

                            <div class="col-md-6">
                                <div class="card h-100 bg-light border-0">
                                    <div class="card-body">
                                        <h4 class="card-title"><i class="bi bi-exclamation-triangle text-warning me-2"></i>Considerations</h4>
                                        <ul class="list-group list-group-flush">
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-dash-circle text-danger me-2"></i>Smaller ecosystem than React</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-dash-circle text-danger me-2"></i>CDN mode limits single-file component usage</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-dash-circle text-danger me-2"></i>Template compilation at runtime adds overhead</li>
                                            <li class="list-group-item bg-transparent border-0"><i class="bi bi-dash-circle text-danger me-2"></i>Requires JavaScript to be enabled in browser</li>
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="mt-4">
                            <h4><i class="bi bi-code-slash me-2"></i>Technical Details</h4>
                            <div class="row g-3 mt-1">
                                <div class="col-md-4">
                                    <div class="card bg-light border-0 h-100">
                                        <div class="card-body">
                                            <h6 class="fw-bold"><i class="bi bi-box me-1"></i> Vue 3</h6>
                                            <p class="small text-muted mb-0">Loaded via CDN. Uses the global build with Composition API (<code>setup()</code>) for reactive state management.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card bg-light border-0 h-100">
                                        <div class="card-body">
                                            <h6 class="fw-bold"><i class="bi bi-arrow-repeat me-1"></i> Reactivity</h6>
                                            <p class="small text-muted mb-0"><code>ref()</code>, <code>computed()</code>, and <code>watch()</code> for fine-grained reactive state tracking without Virtual DOM.</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-4">
                                    <div class="card bg-light border-0 h-100">
                                        <div class="card-body">
                                            <h6 class="fw-bold"><i class="bi bi-cloud-arrow-up me-1"></i> Fetch API</h6>
                                            <p class="small text-muted mb-0">Native browser Fetch API for RESTful CRUD operations â€” no jQuery or Axios dependency.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="card-footer bg-light">
                        <div class="d-flex justify-content-between align-items-center">
                            <span><i class="bi bi-tools me-2"></i>Implementation by Mark Hazleton</span>
                            <a href="https://github.com/markhazleton/UISampleSpark" class="btn btn-outline-primary btn-sm" target="_blank" rel="noopener noreferrer">
                                <i class="bi bi-github me-2"></i>View Source Code
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

@section Scripts {
    <script>
        const { createApp, ref, computed, watch, onMounted, nextTick } = Vue;

        createApp({
            setup() {
                // --- State ---
                const employees = ref([]);
                const departments = ref([]);
                const loading = ref(true);
                const toasts = ref([]);
                const searchTerm = ref('');
                const pageSize = ref(10);
                const currentPage = ref(1);
                const sortKey = ref('name');
                const sortDir = ref('asc');
                const formEmployee = ref({ id: 0, name: '', gender: '', age: '', state: '', country: '', department: '' });
                const formValidated = ref(false);
                const saving = ref(false);
                const deleteTarget = ref(null);
                const formModalEl = ref(null);
                const deleteModalEl = ref(null);

                let formModal = null;
                let deleteModal = null;

                // --- Toast ---
                function addToast(title, message, type) {
                    const id = Date.now();
                    toasts.value.push({ id, title, message, type });
                    setTimeout(() => dismissToast(id), 5000);
                }
                function dismissToast(id) {
                    toasts.value = toasts.value.filter(t => t.id !== id);
                }

                // --- API ---
                async function loadEmployees() {
                    try {
                        const res = await fetch('/api/employee');
                        if (!res.ok) throw new Error('Failed to load employees');
                        employees.value = await res.json();
                    } catch (err) { addToast('Error', err.message, 'danger'); }
                }
                async function loadDepartments() {
                    try {
                        const res = await fetch('/api/department?IncludeEmployees=false');
                        if (!res.ok) throw new Error('Failed to load departments');
                        departments.value = await res.json();
                    } catch (err) { addToast('Error', err.message, 'danger'); }
                }

                // --- Sorting ---
                function toggleSort(key) {
                    if (sortKey.value === key) {
                        sortDir.value = sortDir.value === 'asc' ? 'desc' : 'asc';
                    } else {
                        sortKey.value = key;
                        sortDir.value = 'asc';
                    }
                }
                function sortIcon(col) {
                    if (sortKey.value !== col) return 'bi bi-chevron-expand text-muted';
                    return sortDir.value === 'asc' ? 'bi bi-chevron-up' : 'bi bi-chevron-down';
                }

                // --- Computed ---
                const filtered = computed(() => {
                    if (!searchTerm.value) return employees.value;
                    const term = searchTerm.value.toLowerCase();
                    return employees.value.filter(e =>
                        (e.name || '').toLowerCase().includes(term)
                        || (e.state || '').toLowerCase().includes(term)
                        || (e.country || '').toLowerCase().includes(term)
                        || (e.departmentName || '').toLowerCase().includes(term)
                        || (e.genderName || '').toLowerCase().includes(term)
                    );
                });

                const sorted = computed(() => {
                    return [...filtered.value].sort((a, b) => {
                        const aVal = a[sortKey.value] ?? '';
                        const bVal = b[sortKey.value] ?? '';
                        if (typeof aVal === 'number' && typeof bVal === 'number') {
                            return sortDir.value === 'asc' ? aVal - bVal : bVal - aVal;
                        }
                        const cmp = String(aVal).localeCompare(String(bVal));
                        return sortDir.value === 'asc' ? cmp : -cmp;
                    });
                });

                const totalPages = computed(() => Math.ceil(sorted.value.length / pageSize.value));

                const paginated = computed(() => {
                    const start = (currentPage.value - 1) * pageSize.value;
                    return sorted.value.slice(start, start + pageSize.value);
                });

                const visiblePages = computed(() => {
                    const pages = [];
                    const max = 5;
                    let start = Math.max(1, currentPage.value - Math.floor(max / 2));
                    let end = Math.min(totalPages.value, start + max - 1);
                    if (end - start + 1 < max) start = Math.max(1, end - max + 1);
                    for (let i = start; i <= end; i++) pages.push(i);
                    return pages;
                });

                // Reset page on search/pageSize change
                watch([searchTerm, pageSize], () => { currentPage.value = 1; });

                // --- CRUD ---
                function openAdd() {
                    formEmployee.value = { id: 0, name: '', gender: '', age: '', state: '', country: '', department: '' };
                    formValidated.value = false;
                    saving.value = false;
                    formModal.show();
                }

                async function openEdit(id) {
                    try {
                        const res = await fetch('/api/employee/' + id);
                        if (!res.ok) throw new Error('Failed to load employee');
                        const data = await res.json();
                        const emp = data.resource;
                        formEmployee.value = {
                            id: emp.id,
                            name: emp.name || '',
                            gender: emp.gender != null ? emp.gender : '',
                            age: emp.age || '',
                            state: emp.state || '',
                            country: emp.country || '',
                            department: emp.department != null ? emp.department : ''
                        };
                        formValidated.value = false;
                        saving.value = false;
                        formModal.show();
                    } catch (err) { addToast('Error', err.message, 'danger'); }
                }

                async function handleSave() {
                    const formEl = document.getElementById('vueEmployeeForm');
                    if (!formEl.checkValidity()) {
                        formValidated.value = true;
                        return;
                    }
                    saving.value = true;
                    try {
                        const payload = {
                            id: parseInt(formEmployee.value.id) || 0,
                            name: formEmployee.value.name,
                            gender: parseInt(formEmployee.value.gender),
                            age: parseInt(formEmployee.value.age),
                            state: formEmployee.value.state,
                            country: formEmployee.value.country,
                            department: parseInt(formEmployee.value.department)
                        };
                        const isEdit = payload.id > 0;
                        const url = isEdit ? '/api/employee/' + payload.id : '/api/employee';
                        const method = isEdit ? 'PUT' : 'POST';
                        const res = await fetch(url, {
                            method,
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });
                        if (!res.ok) {
                            const text = await res.text();
                            throw new Error(text || 'Failed to save employee');
                        }
                        addToast('Success', isEdit ? 'Employee updated successfully' : 'Employee added successfully', 'success');
                        formModal.hide();
                        await loadEmployees();
                    } catch (err) {
                        addToast('Error', err.message, 'danger');
                    } finally {
                        saving.value = false;
                    }
                }

                function openDelete(emp) {
                    deleteTarget.value = emp;
                    deleteModal.show();
                }

                async function handleDelete() {
                    try {
                        const res = await fetch('/api/employee/' + deleteTarget.value.id, {
                            method: 'DELETE',
                            headers: { 'Content-Type': 'application/json' }
                        });
                        if (!res.ok) {
                            const text = await res.text();
                            throw new Error(text || 'Failed to delete employee');
                        }
                        addToast('Success', 'Employee deleted successfully', 'success');
                        deleteModal.hide();
                        deleteTarget.value = null;
                        await loadEmployees();
                    } catch (err) {
                        addToast('Error', err.message, 'danger');
                    }
                }

                // --- Init ---
                onMounted(async () => {
                    formModal = new bootstrap.Modal(document.getElementById('vueFormModal'));
                    deleteModal = new bootstrap.Modal(document.getElementById('vueDeleteModal'));
                    await Promise.all([loadEmployees(), loadDepartments()]);
                    loading.value = false;
                });

                return {
                    employees, departments, loading, toasts, searchTerm,
                    pageSize, currentPage, sortKey, sortDir,
                    formEmployee, formValidated, saving, deleteTarget,
                    formModalEl, deleteModalEl,
                    filtered, sorted, paginated, totalPages, visiblePages,
                    toggleSort, sortIcon, addToast, dismissToast,
                    openAdd, openEdit, handleSave, openDelete, handleDelete
                };
            }
        }).mount('#vue-root');
    </script>
}
